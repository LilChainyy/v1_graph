<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>UNH Stock Chart</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  :root {
    --green:#0a8a0a; --ink:#111; --bg:#fff; --muted:#6b7280; --purple:#6b46c1; --grey:#9ca3af;
  }
  html,body { margin:0; padding:0; background:var(--bg); color:var(--ink);
    font:14px/1.45 -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif; }
  .wrap { max-width: 1000px; margin:24px auto; padding:0 16px; }
  h1 { font-size:20px; margin:8px 0 16px; }
  .chart-box { position:relative; height:520px; background:#fff; border-radius:12px;
    box-shadow:0 1px 4px rgba(0,0,0,.06); padding:16px; }
  /* Base tooltip = dark bubble (for normal tracing) */
  .tooltip {
    position:absolute; background:rgba(16,16,16,.92); color:#fff; padding:6px 8px; border-radius:8px;
    font-size:12px; pointer-events:none; transform:translate(6px,-6px); /* CHANGED: closer */
    opacity:0; transition:opacity .12s;
  }
  .tooltip.show { opacity:1; }
  /* Earnings style toggled via .earn class */
  .tooltip.earn { background:#fff; color:var(--ink); border:2px solid var(--purple);
    box-shadow:0 1px 6px rgba(0,0,0,.08); }
  .legend { margin:10px 4px 0; color:var(--muted); font-size:12px; display:flex; gap:12px; align-items:center; }
  .legend .dot::before { content:'‚óè'; margin-right:6px; }
  .legend .actual::before { color:var(--green); }
  .legend .stub::before { color:var(--grey); }
  .legend .earn::before { color:var(--purple); }
  .q { color:var(--purple); font-weight:600; }
  .up { color:#166534; font-weight:600; }
  .down { color:#991b1b; font-weight:600; }
</style>
</head>
<body>
  <div class="wrap">
    <h1>üíπ UNH ‚Äî Close Price</h1>
    <div class="legend">
      <span class="dot actual">Actual through Sep 10, 2025</span>
      <span class="dot stub">No prices yet (flat to Dec 31)</span>
      <span class="dot earn">Earnings dates</span>
    </div>
    <div class="chart-box">
      <canvas id="chart"></canvas>
      <div id="tooltip" class="tooltip"></div>
    </div>
  </div>

<script>
  const actualDates    = ["2025-01-02", "2025-01-03", "2025-01-06", "2025-01-07", "2025-01-08", "2025-01-10", "2025-01-13", "2025-01-14", "2025-01-15", "2025-01-16", "2025-01-17", "2025-01-21", "2025-01-22", "2025-01-23", "2025-01-24", "2025-01-27", "2025-01-28", "2025-01-29", "2025-01-30", "2025-01-31", "2025-02-03", "2025-02-04", "2025-02-05", "2025-02-06", "2025-02-07", "2025-02-10", "2025-02-11", "2025-02-12", "2025-02-13", "2025-02-14", "2025-02-18", "2025-02-19", "2025-02-20", "2025-02-21", "2025-02-24", "2025-02-25", "2025-02-26", "2025-02-27", "2025-02-28", "2025-03-03", "2025-03-04", "2025-03-05", "2025-03-06", "2025-03-07", "2025-03-10", "2025-03-11", "2025-03-12", "2025-03-13", "2025-03-14", "2025-03-17", "2025-03-18", "2025-03-19", "2025-03-20", "2025-03-21", "2025-03-24", "2025-03-25", "2025-03-26", "2025-03-27", "2025-03-28", "2025-03-31", "2025-04-01", "2025-04-02", "2025-04-03", "2025-04-04", "2025-04-07", "2025-04-08", "2025-04-09", "2025-04-10", "2025-04-11", "2025-04-14", "2025-04-15", "2025-04-16", "2025-04-17", "2025-04-21", "2025-04-22", "2025-04-23", "2025-04-24", "2025-04-25", "2025-04-28", "2025-04-29", "2025-04-30", "2025-05-01", "2025-05-02", "2025-05-05", "2025-05-06", "2025-05-07", "2025-05-08", "2025-05-09", "2025-05-12", "2025-05-13", "2025-05-14", "2025-05-15", "2025-05-16", "2025-05-19", "2025-05-20", "2025-05-21", "2025-05-22", "2025-05-23", "2025-05-27", "2025-05-28", "2025-05-29", "2025-05-30", "2025-06-02", "2025-06-03", "2025-06-04", "2025-06-05", "2025-06-06", "2025-06-09", "2025-06-10", "2025-06-11", "2025-06-12", "2025-06-13", "2025-06-16", "2025-06-17", "2025-06-18", "2025-06-20", "2025-06-23", "2025-06-24", "2025-06-25", "2025-06-26", "2025-06-27", "2025-06-30", "2025-07-01", "2025-07-02", "2025-07-03", "2025-07-07", "2025-07-08", "2025-07-09", "2025-07-10", "2025-07-11", "2025-07-14", "2025-07-15", "2025-07-16", "2025-07-17", "2025-07-18", "2025-07-21", "2025-07-22", "2025-07-23", "2025-07-24", "2025-07-25", "2025-07-28", "2025-07-29", "2025-07-30", "2025-07-31", "2025-08-01", "2025-08-04", "2025-08-05", "2025-08-06", "2025-08-07", "2025-08-08", "2025-08-11", "2025-08-12", "2025-08-13", "2025-08-14", "2025-08-15", "2025-08-18", "2025-08-19", "2025-08-20", "2025-08-21", "2025-08-22", "2025-08-25", "2025-08-26", "2025-08-27", "2025-08-28", "2025-08-29", "2025-09-02", "2025-09-03", "2025-09-04", "2025-09-05", "2025-09-08", "2025-09-09", "2025-09-10"];
  const actualPrices   = [498.822021484375, 507.21630859375, 507.87872314453125, 508.45220947265625, 518.6064453125, 514.8196411132812, 535.0390625, 537.6097412109375, 537.2933349609375, 504.8334655761719, 504.0128173828125, 519.0711059570312, 513.8605346679688, 523.7972412109375, 526.50634765625, 537.3922119140625, 536.3638916015625, 532.0332641601562, 539.4191284179688, 536.373779296875, 541.9996337890625, 539.3004150390625, 533.7240600585938, 524.0641479492188, 521.0881958007812, 527.356689453125, 527.9004516601562, 521.4539794921875, 525.1912841796875, 517.6077880859375, 495.08465576171875, 505.2784118652344, 496.755615234375, 461.1614685058594, 456.31671142578125, 465.0768127441406, 458.36334228515625, 463.27734375, 469.60516357421875, 461.7843322753906, 469.25909423828125, 470.61370849609375, 482.2213134765625, 487.9164123535156, 476.83502197265625, 482.614013671875, 477.71875, 478.1258544921875, 485.2055969238281, 495.50250244140625, 500.2488098144531, 499.653076171875, 507.6959533691406, 513.206787109375, 512.8593139648438, 509.8109436035156, 514.5473022460938, 512.0847778320312, 512.4025268554688, 520.0582275390625, 519.4326171875, 519.5120849609375, 536.6305541992188, 521.3489990234375, 521.0015258789062, 549.1814575195312, 574.4223022460938, 590.210205078125, 595.2444458007812, 582.9219360351562, 579.4764404296875, 580.9161376953125, 450.9090576171875, 422.3319396972656, 424.16888427734375, 424.9433898925781, 421.2595520019531, 415.6891174316406, 417.0395202636719, 406.3454284667969, 408.53985595703125, 397.8556823730469, 397.10107421875, 401.9565734863281, 391.72918701171875, 388.3034973144531, 382.83233642578125, 377.95697021484375, 376.08026123046875, 309.1851501464844, 305.83892822265625, 272.4161682128906, 289.8523864746094, 313.6633605957031, 319.313232421875, 300.8443603515625, 294.578857421875, 293.4866027832031, 292.92059326171875, 296.0086669921875, 296.0682678222656, 299.7818908691406, 302.57208251953125, 299.0967712402344, 298.2626953125, 293.7546691894531, 301.0826721191406, 301.0528869628906, 301.6486511230469, 308.3709411621094, 316.2549743652344, 311.32000732421875, 307.6600036621094, 308.8699951171875, 307.20001220703125, 302.010009765625, 300.67999267578125, 305.6199951171875, 302.0199890136719, 302.6199951171875, 309.1099853515625, 311.9700012207031, 326.1400146484375, 307.55999755859375, 308.54998779296875, 303.7099914550781, 307.70001220703125, 302.9100036621094, 299.510009765625, 304.1000061035156, 300.5799865722656, 291.7099914550781, 292.489990234375, 288.07000732421875, 282.6499938964844, 282.1400146484375, 285.1300048828125, 292.510009765625, 278.5799865722656, 281.05999755859375, 282.1199951171875, 261.07000732421875, 266.0400085449219, 249.55999755859375, 237.77000427246094, 240.97999572753906, 251.0, 245.77999877929688, 244.6699981689453, 250.88999938964844, 252.3699951171875, 261.57000732421875, 271.80999755859375, 271.489990234375, 304.010009765625, 308.489990234375, 304.239990234375, 299.8399963378906, 303.3500061035156, 307.4200134277344, 304.8599853515625, 300.42999267578125, 303.8800048828125, 302.2900085449219, 309.8699951171875, 308.79998779296875, 307.8800048828125, 310.3800048828125, 315.3900146484375, 320.25, 347.9200134277344, 345.927490234375];
  const stubDates      = ["2025-09-11", "2025-09-12", "2025-09-13", "2025-09-14", "2025-09-15", "2025-09-16", "2025-09-17", "2025-09-18", "2025-09-19", "2025-09-20", "2025-09-21", "2025-09-22", "2025-09-23", "2025-09-24", "2025-09-25", "2025-09-26", "2025-09-27", "2025-09-28", "2025-09-29", "2025-09-30", "2025-10-01", "2025-10-02", "2025-10-03", "2025-10-04", "2025-10-05", "2025-10-06", "2025-10-07", "2025-10-08", "2025-10-09", "2025-10-10", "2025-10-11", "2025-10-12", "2025-10-13", "2025-10-14", "2025-10-15", "2025-10-16", "2025-10-17", "2025-10-18", "2025-10-19", "2025-10-20", "2025-10-21", "2025-10-22", "2025-10-23", "2025-10-24", "2025-10-25", "2025-10-26", "2025-10-27", "2025-10-28", "2025-10-29", "2025-10-30", "2025-10-31", "2025-11-01", "2025-11-02", "2025-11-03", "2025-11-04", "2025-11-05", "2025-11-06", "2025-11-07", "2025-11-08", "2025-11-09", "2025-11-10", "2025-11-11", "2025-11-12", "2025-11-13", "2025-11-14", "2025-11-15", "2025-11-16", "2025-11-17", "2025-11-18", "2025-11-19", "2025-11-20", "2025-11-21", "2025-11-22", "2025-11-23", "2025-11-24", "2025-11-25", "2025-11-26", "2025-11-27", "2025-11-28", "2025-11-29", "2025-11-30", "2025-12-01", "2025-12-02", "2025-12-03", "2025-12-04", "2025-12-05", "2025-12-06", "2025-12-07", "2025-12-08", "2025-12-09", "2025-12-10", "2025-12-11", "2025-12-12", "2025-12-13", "2025-12-14", "2025-12-15", "2025-12-16", "2025-12-17", "2025-12-18", "2025-12-19", "2025-12-20", "2025-12-21", "2025-12-22", "2025-12-23", "2025-12-24", "2025-12-25", "2025-12-26", "2025-12-27", "2025-12-28", "2025-12-29", "2025-12-30", "2025-12-31"];
  const stubPrices     = [345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375, 345.927490234375];
  const earningsDates  = ["2025-01-16", "2025-04-15", "2025-07-16", "2025-10-15"];
  const earningsPrices = [504.8334655761719, 579.4764404296875, 292.489990234375, 345.927490234375];
  const earningsQuarts = ["Q4 quarter", "Q1 quarter", "Q2 quarter", "Q3 quarter"];
  const earningsDols   = [-32.459869384765625, -3.44549560546875, 0.779998779296875, -1.992523193359375];  // CHANGED ($ move)

  const labels = actualDates.concat(stubDates);
  const labelIndex = new Map(labels.map((d,i)=>[d,i]));

  const earningsSeries = Array(labels.length).fill(null);
  const eMeta = {}; // date -> quarter and dollars
  earningsDates.forEach((d, k) => {
    const i = labelIndex.get(d);
    if (i != null) {
      earningsSeries[i] = Number(earningsPrices[k]);
      eMeta[d] = {quarter: earningsQuarts[k], dollars: Number(earningsDols[k])};
    }
  });

  const ctx = document.getElementById('chart').getContext('2d');
  const tooltipEl = document.getElementById('tooltip');

  const chart = new Chart(ctx, {
    type: 'line',
    data: {
      labels,
      datasets: [
        {
          label: 'Close (actual)',
          data: actualPrices,
          borderColor: '#0a8a0a',
          backgroundColor: 'transparent',
          borderWidth: 2.5,
          pointRadius: 0,
          tension: 0
        },
        {
          label: 'No prices yet',
          data: Array(actualPrices.length).fill(null).concat(stubPrices),
          borderColor: '#9ca3af',
          backgroundColor: 'transparent',
          borderWidth: 2,
          borderDash: [6,6],
          pointRadius: 0,
          tension: 0
        },
        {
          label: 'Earnings',
          data: earningsSeries,
          borderColor: 'transparent',
          backgroundColor: 'transparent',
          showLine: false,
          pointRadius: 7,
          pointHoverRadius: 9,
          pointBackgroundColor: '#6b46c1',
          pointBorderColor: '#6b46c1',
          pointBorderWidth: 2,
        }
      ]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      animation: false,
      plugins: { legend: { display:false }, tooltip: { enabled:false } },
      scales: { x: { display:false }, y: { display:false } },
      interaction: { mode: 'index', intersect: false },
      onHover(evt, active) {
        const rect = evt.chart.canvas.getBoundingClientRect();
        const idx = active.length ? active[0].index : null;
        if (idx == null) {
          tooltipEl.classList.remove('show','earn'); // CHANGED: remove style
          return;
        }
        const label = labels[idx];
        const isEarnings = earningsSeries[idx] != null;

        if (isEarnings) {
          const meta = eMeta[label] || {quarter:'', dollars:0};
          const sign = meta.dollars >= 0 ? 'up' : 'down';
          const amt  = Math.abs(meta.dollars).toFixed(2);
          // CHANGED: earnings tooltip = white card + purple frame
          tooltipEl.classList.add('earn');
          tooltipEl.innerHTML = `
            <div class="q">${meta.quarter}</div>
            <div>Q earnings hit, price <span class="${sign}">${sign} $${amt}</span></div>
          `;
        } else {
          // CHANGED: normal tracing uses dark tooltip (no purple frame)
          tooltipEl.classList.remove('earn');
          let price = null;
          if (idx < actualPrices.length && actualPrices[idx] != null) {
            price = Number(actualPrices[idx]);
          } else {
            const stubIdx = idx - actualPrices.length;
            if (stubIdx >= 0 && stubPrices[stubIdx] != null) {
              price = Number(stubPrices[stubIdx]);
            }
          }
          tooltipEl.innerHTML = `${label}<br>Close: $${price?.toFixed(2) ?? '‚Äî'}`;
        }

        tooltipEl.style.left = (evt.x - rect.left + 6) + 'px';  // CHANGED: closer
        tooltipEl.style.top  = (evt.y - rect.top  - 6) + 'px';  // CHANGED: closer
        tooltipEl.classList.add('show');
      }
    }
  });
</script>
</body>
</html>
